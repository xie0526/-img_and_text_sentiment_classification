# 多模态情感分析

---

## 实验简介
1. 实现一个多模态情感分类模型，结合了文本和图像信息来进行情感分类。
2. 通过只输入图片或者文本的方式进行消融实验

---

## 文件结构  
- data.py # 数据加载与预处理
- evaluate_model.py # 模型评估
- models.py # 文字编码器和图像编码器以及多模态模型建构
- image_only_model.py # 消融实验图像模型
- text_only_model.py # 消融实验文本模型
- train.py # 训练函数
- predict.py #预测函数
- 消融实验.ipynb # 可直接实现消融实验，训练多模态模型、文本模型、图像模型并评估
- 预测结果.ipynb # 可直接加载数据集文件并预测结果
- requesments.txt 项目所需环境
- README.md # 项目文档

---

## 实验环境
实验环境：GPU RTX 4090D(24GB)

---

## 依赖环境安装
pip install -r requirements.txt<br>

---

## 模型介绍

### 1. **多模态模型 (Multimodal Model)**

**多模态模型**旨在通过结合文本和图像信息进行情感分析。它利用**文本编码器**（如 BERT）处理文本输入，使用**图像编码器**（如 ResNet50）处理图像输入。通过融合这两种模态，模型能够利用文本和图像中提供的互补信息，从而提高情感分类的性能。多模态方法特别适用于文本和图像提供互补线索的情感分析任务。

- **文本输入**：模型使用 BERT（或类似的模型）来提取文本特征。
- **图像输入**：模型使用预训练的卷积神经网络（如 ResNet50）来提取图像特征。
- **输出**：最终输出是基于文本和图像输入的情感分类结果。

---

### 2. **文本单模态模型 (Text-Only Model)**

**文本单模态模型**仅使用文本信息进行情感分析。它通过**文本编码器**（如 BERT）处理输入的文本，并生成文本特征嵌入，然后将这些嵌入通过全连接层进行情感分类。该模型的输出是基于文本的情感标签（例如，正向、负向、中立）。

- **输入**：输入为一段文本，文本经过分词和编码后传入模型。
- **输出**：模型输出文本的情感标签（如正向、负向或中立）。

此模型适用于只有文本数据可用的情感分析任务。

---

### 3. **图像单模态模型 (Image-Only Model)**

**图像单模态模型**仅使用图像信息进行情感分析。它通过**图像编码器**（如 ResNet50）处理图像并提取特征，然后通过全连接层对情感进行分类。该模型的输出是基于图像的情感标签。

- **输入**：输入为图像，经过预处理后输入到图像编码器。
- **输出**：模型输出图像的情感标签（如正向、负向或中立）。

该模型适用于只有图像数据可用的情感分析任务。

---

## 使用方法
- 1. 需要自行加载数据并将适当修改代码中训练与预测数据集文件格式
- 2. 文本编码器中的BERT模型初始化需要适当自行在huggingface官网下载，并修改代码中的文件路径

---
## 作者
郑泽林10213360456@stu.ecnu.edu.cn
